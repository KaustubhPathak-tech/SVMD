{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Successful Transactions{% endblock %}

{% block content %}
<div class="container-fluid">

    <h1 class="mb-4">Successful Transactions</h1>

    {% if transactions %}
        <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>Transaction ID</th>
                        <th>Donor Name</th>
                        <th>Profile</th>
                        <th>Amount (₹)</th>
                        <th>Status</th>
                        <th>Transaction Date</th>
                        <th>Receipt</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tx in transactions %}
                        <tr>
                            <td>{{ forloop.counter }}</td>

                            <td>
                                <strong>{{ tx.transaction_id }}</strong>
                            </td>

                            <td>{{ tx.donor_name }}</td>

                            <td>
                                {{ tx.profile }}
                            </td>

                            <td>
                                ₹{{ tx.amount }}
                            </td>

                            <td>
                                <span class="badge 
                                    {% if tx.status == 'RECEIPT_SENT' %}
                                        bg-success
                                    {% elif tx.status == 'APPROVED' %}
                                        bg-primary
                                    {% else %}
                                        bg-secondary
                                    {% endif %}
                                ">
                                    {{ tx.get_status_display }}
                                </span>
                            </td>

                            <td>
                                {{ tx.transaction_date|date:"d M Y, H:i" }}
                            </td>

                            <td>
                                {% if tx.receipt_file %}
                                    <a href="{{ tx.receipt_file.url }}" 
                                       class="btn btn-sm btn-outline-success"
                                       target="_blank">
                                        View
                                    </a>
                                {% else %}
                                    <span class="text-muted">Not Uploaded</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

    {% else %}
        <div class="alert alert-warning">
            No successful transactions found.
        </div>
    {% endif %}

</div>
{% endblock %}
